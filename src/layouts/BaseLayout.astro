---
import Nav from '../components/Nav.astro';
import type { Tab } from '../components/Nav.astro';
import Footer from '../components/Footer.astro';
import BackToTop from '../components/BackToTop.astro';
import PageMeta from '../components/PageMeta.astro';

interface Props {
    activeTab?: Tab;
    pageTitle?: string;
    pageDescription?: string;
}

const { activeTab, pageTitle, pageDescription }: Props = Astro.props;


const isProd = import.meta.env.PROD;

---
<!DOCTYPE html>
<html lang="en">
	<head>
        <PageMeta 
            title={pageTitle}
            description={pageDescription}
        />
        <slot name="head" />

        <style>
            html {
                @apply bg-zinc-900 h-full text-neutral-50;
            }

            body {
                @apply h-full;
            }

            .bg {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                min-height: 100vh;
                pointer-events: none;
                z-index: -1;
            }

            #bg-grid {
                background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%239C92AC' fill-opacity='0.1'%3E%3Cpath opacity='.1' d='M96 95h4v1h-4v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9zm-1 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9z'/%3E%3Cpath d='M6 5V0H5v5H0v1h5v94h1V6h94V5H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            }

            #bg-noise {
                background-image: url(/images/noise.png);
                opacity: 0.3;
                mix-blend-mode: multiply;
            }
        </style>

        {/* Only set up Plausible Analytics if running in production */}
        {isProd && (
            <script
                is:inline 
                defer 
                id="plausible-script"
                data-domain="austinpoor.com"
                src="/stats/js/script.outbound-links.tagged-events.js"
                data-api="/stats/api/event"
            >
            </script>
            <script is:inline>window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }</script>
        )}
	</head>
	<body class="relative ">
        <Nav activeTab={activeTab}/>

        <header>
            <slot name="header" />
        </header>

        <main>
            <slot />
        </main>

        <BackToTop />
        
        <Footer>
            <slot name="footer" />
        </Footer>
        
        <div class="bg" id="bg-noise"/>
        <div class="bg" id="bg-grid"/>
	</body>
</html>
